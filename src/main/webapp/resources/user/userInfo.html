<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<title>我的简历</title>
     
    
	<!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <!-- no chache -->
    <meta http-equiv="Cache-Control" content="no-cache">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/media50px.min.css">
    <link rel="stylesheet" href="../css/alt.css">
    <link rel="stylesheet" href="../css/index.css">
    
<script src="../js/zepto.min.js"></script>
<script src="../js/touch.js"></script>
<script src="../js/alt.js"></script>
<script>
	// 操作cookie
	// 获取cookie
	function getCookie(c_name){
		if (document.cookie.length>0){
			var c_start=document.cookie.indexOf(c_name + "=");
			if (c_start!=-1){
				c_start=c_start + c_name.length+1;
				var c_end=document.cookie.indexOf(";",c_start);
				if (c_end==-1){
					c_end=document.cookie.length;
				}
				return unescape(document.cookie.substring(c_start,c_end))
			}
		}
		return ""
	}

	// 设置cookie
	function setCookie(c_name,value,expiredays){
		var exdate=new Date()
		exdate.setDate(exdate.getDate()+expiredays)
		document.cookie=c_name+ "=" +escape(value)+
		((expiredays==null) ? "" : ";expires="+exdate.toGMTString())
	}

	// 检查cookie
	function checkCookie(c_name){
		var c_name=getCookie(c_name)
		if(c_name!=null && c_name!=""){
			return true;
		}else{
			return false;
		}
	}

	//禁止鼠标右键
	document.oncontextmenu=function(){
	    return false;
	};

	// 手机
	function isMobile(text) {
		return /^((17[0-9])|(14[0-9])|(13[0-9])|(15[^4,\D])|(18[0-9]))\d{8}$/.test(text);
	}

	// 邮箱
	function isEmail(text) {
		return /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(text);
	}

	// 日期
	function isDate(text) {
		//if (!/^(\d{4})-(\d{2})-(\d{2})$/.test(text)) {
		//	return false;
		//}
		// try {
		// 	var date = new Date(text);	
		// 	return true;
		// } catch (Exception e) {
		// 	return false;
		// }
		return (new Date(text).getDate() == text.substring(text.length-2));
	}

	// 密码
	function isPasswprd(text) {
		return /[a-zA-Z0-9]{6,16}/.test(text);
	}
	
	// 姓名
	function isName(text) {
		return text.length > 1 && text.length < 5 && /[\u4e00-\u9fa5A-Za-z.]{2,10}$/.test(text);
	}

	//弹窗封装
    function show_alert(text){
        var oApplyAlt=new _alert({
            cnt:'<div id="jianli_alt" style="text-align:center;">'+
            '<p style="padding:10px 0;font-size: 0.32rem;">'+text+'</p>'+
            '</div>',
            ft:'<div class="m-tc_btn"><a class="quxiao" href="javascript:" style="color: #fe7418; border: none;">确定</a></div>',
            overlay:true
        }).build();
        $(oApplyAlt).css({"top":"20%","z-index":"10"})
    }

    //确定按钮
    $(document).on('click','.quxiao',function (e) {
        clearTimeout(t)
        var t=setTimeout($(".cl_btn").click(),500)
    })

</script>
</head>
<body>
<div class="g-usercenter">
   
<div class="g-reg f-pr" style="min-height: 9rem;">
    <!-- 头部 start -->
    <div class="m-xqtop f-pr" style="margin-bottom: 0">
        <a href="javascript:history.go(-1);" class="last"> <img src="../img/last.png" alt=""> </a>
        <h2>我的简历</h2>
        <div class="m-backIndex f-fr">
            <a href="#" class="m-backIndex_btn">首页</a>
        </div>
    </div>
    <!-- 注册页面 主体 -->
    <div class="m-reg_box m-data_box">
        <div class="m-reg_input">
            <p class="u-b_t u-bsa">
                <label class="g-top10"><span class="u-bixuan">*</span>头像</label>
                <span class="g-tx80 f-fr">
                    <img id="user_logo" src="../img/logo.png" width="100%" alt="">
                </span>
            </p>
            <p class="u-b_t"><label><span class="u-bixuan">*</span>姓名</label><input id="user_name" type="text" value="" placeholder=""></p>
            <div class="f-pr">
               <p class="u-b_t"><label><span class="u-bixuan">*</span>性别</label></p>
                <ul id="user_sex" class="j-sex f-cb">
                	
	                    <li class="f-fl man cur">男</li>
	                    <li class="f-fl woman">女</li>
                    
                    
                    
                </ul>
            </div>
            <p class="u-b_t"><label for="user_birthday"><span class="u-bixuan">*</span>出生年月</label><input id="user_birthday" value="" type="data" placeholder="请输入生日，如1999-01-01"></p>
            <p class="u-b_t u-bsa"><label for="user_phone"><span class="u-bixuan">*</span><span class="u-bixuan"></span>电话</label><input readonly="" id="user_phone" type="text" maxlength="11" value="" placeholder="请输入手机号码"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>邮箱</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>学校</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>学院</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>专业</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>入学年份</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
            <p class="u-b_t u-b_b"><label for="user_email"><span class="u-bixuan">*</span><span class="u-bixuan"></span>我的标签</label><input id="user_email" type="text" maxlength="30" value="" placeholder="请输入邮箱"></p>
                     
            <a href="#" class="m-inputbtn">确定</a>
        </div>
    </div>
    <div class="m-login_b">
        <p style="color: #666666"><a style="color: #2b80f3" href="#">下载兼职猫</a>完善更多资料，录取几率更大哦！</p>
    </div>
</div>
<script>

window.onload=function(){
    // 选择性别
    $('.j-sex li').click(function(){
        $(this).addClass("cur").siblings().removeClass("cur")
    });

    //修改头像
    $('.g-tx80').tap(function(){
        var user_logo = $("#user_logo").attr("src")
        var user_phone=$("#user_phone").val()
        var user_name=$("#user_name").val()
        var user_email=$("#user_email").val()
        var user_sex='男'
        var user_birthday=$("#user_birthday").val()
        //修改头像
        //location.href="/user/renderLogoChange?logo=" + user_logo + "&phone=" + user_phone + "&name=" + user_name + "&email=" + user_email + "&sex=" + user_sex + "&birthday=" + user_birthday
    })

    //修改电话
    $('#user_phone').tap(function(){
        var user_logo = $("#user_logo").attr("src")
        var user_phone=$("#user_phone").val()
        var user_name=$("#user_name").val()
        var user_email=$("#user_email").val()
        var user_sex='男'
        var user_birthday=$("#user_birthday").val()
       //进入修改电话页面
      //  location.href="/user/renderPhoneChange?logo=" + user_logo + "&phone=" + user_phone + "&name=" + user_name + "&email=" + user_email + "&sex=" + user_sex + "&birthday=" + user_birthday
    })

    // 注册按钮点击时进行前端表单验证
    $('.m-inputbtn').click(function(){
        var user_logo = $("#user_logo").attr("src")
        var user_phone=$("#user_phone").val()
		var user_name=$("#user_name").val()
        var user_email=$("#user_email").val()
		var user_sex='男'
        var user_birthday=$("#user_birthday").val()
		$("#user_sex li").each(function(){
			if($(this).is(".cur")){
				user_sex=$(this).html();
			}
		}); 
        if(!isName(user_name)) {
            show_alert("请输入正确的姓名");
            return;
        }
        if(!isMobile(user_phone)){
            show_alert("请输入正确的手机号码")
            return;
        }
        if (!isDate(user_birthday)) {
            show_alert("请输入正确的日期<br>格式为1999-11-11");
            return;
        }
        if (!isEmail(user_email)) {
            show_alert("请输入正确的邮箱");
            return;
        }
        //注意，后端验证返回到前端 也调用show_alert方法，仅在当前页面调用有效
		$.ajax({
	          type: 'POST',
	          url: '/user/updateUserDate',
	          data: {
                  user_logo : user_logo,
	        	  user_name: user_name,
	        	  user_phone: user_phone,
	        	  user_sex: user_sex,
	        	  user_birthday:user_birthday,
                  user_email : user_email
	            },
	          dataType: 'json',
	          success: function(data){
	            if( data.result== 102 ){
	            	show_alert("请先登录！");
	                location.href = "/login.jsp";
	            }else if(data.result== 200){
                    show_alert("操作成功");
                    $(".cl_btn").click(function () {
                        window.location.href = "/user/toUserCenter";
                    })
	            }else if(data.result== 100){
	            	show_alert("操作失败");
	            }
	          },
	          error: function(xhr, type){
	            show_alert("网络错误");
	          },
	          complete : function () {
	        	  
	          }
	    })
    });
	}
    //获取手机验证码
    function time(o) {
        clearTimeout(t)
        if (wait == 0) {
            o.innerHTML = "发送";
			o.style.background = "#5da72a";
        } else {
			o.style.background = "#E2E1E1";
            o.innerHTML = "等待(" + wait + ")";
            wait--;
            var t=setTimeout(function() {
                        time(o)
                    },
                    1000)
        }
    }
    //获取短信验证码120S倒计时调用
    $(".m-yanzhengma").click(function(){
            //alert($(this).html()!="发送")
            if($(this).html()!="发送"){
                 return ;
            }else{
                 wait = 120;
                time(this);
            }
    });
</script>

</div></body></html>